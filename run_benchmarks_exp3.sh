#!/usr/bin/env bash
set -euo pipefail

SLEEP=10

commands=(
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b pagerank --pagerank::niters 20 -p 16 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-pagerank-th16-mem8g-r0.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b pagerank --pagerank::niters 20 -p 8 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-pagerank-th8-mem8g-r0.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b pagerank --pagerank::niters 20 -p 4 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-pagerank-th4-mem8g-r0.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b pagerank --pagerank::niters 20 -p 2 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-pagerank-th2-mem8g-r0.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b pagerank --pagerank::niters 20 -p 1 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-pagerank-th1-mem8g-r0.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b pagerank --pagerank::niters 20 -p 16 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-pagerank-th16-mem8g-r1.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b pagerank --pagerank::niters 20 -p 8 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-pagerank-th8-mem8g-r1.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b pagerank --pagerank::niters 20 -p 4 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-pagerank-th4-mem8g-r1.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b pagerank --pagerank::niters 20 -p 2 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-pagerank-th2-mem8g-r1.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b pagerank --pagerank::niters 20 -p 1 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-pagerank-th1-mem8g-r1.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b pagerank --pagerank::niters 20 -p 16 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-pagerank-th16-mem8g-r2.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b pagerank --pagerank::niters 20 -p 8 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-pagerank-th8-mem8g-r2.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b pagerank --pagerank::niters 20 -p 4 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-pagerank-th4-mem8g-r2.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b pagerank --pagerank::niters 20 -p 2 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-pagerank-th2-mem8g-r2.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b pagerank --pagerank::niters 20 -p 1 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-pagerank-th1-mem8g-r2.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67_sym -b cc -p 16 -a --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-wcc-th16-mem8g-r0.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67_sym -b cc -p 8 -a --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-wcc-th8-mem8g-r0.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67_sym -b cc -p 4 -a --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-wcc-th4-mem8g-r0.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67_sym -b cc -p 2 -a --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-wcc-th2-mem8g-r0.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67_sym -b cc -p 1 -a --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-wcc-th1-mem8g-r0.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67_sym -b cc -p 16 -a --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-wcc-th16-mem8g-r1.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67_sym -b cc -p 8 -a --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-wcc-th8-mem8g-r1.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67_sym -b cc -p 4 -a --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-wcc-th4-mem8g-r1.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67_sym -b cc -p 2 -a --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-wcc-th2-mem8g-r1.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67_sym -b cc -p 1 -a --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-wcc-th1-mem8g-r1.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67_sym -b cc -p 16 -a --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-wcc-th16-mem8g-r2.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67_sym -b cc -p 8 -a --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-wcc-th8-mem8g-r2.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67_sym -b cc -p 4 -a --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-wcc-th4-mem8g-r2.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67_sym -b cc -p 2 -a --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-wcc-th2-mem8g-r2.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67_sym -b cc -p 1 -a --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-wcc-th1-mem8g-r2.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b spmv -p 16 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-spmv-th16-mem8g-r0.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b spmv -p 8 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-spmv-th8-mem8g-r0.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b spmv -p 4 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-spmv-th4-mem8g-r0.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b spmv -p 2 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-spmv-th2-mem8g-r0.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b spmv -p 1 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-spmv-th1-mem8g-r0.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b spmv -p 16 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-spmv-th16-mem8g-r1.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b spmv -p 8 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-spmv-th8-mem8g-r1.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b spmv -p 4 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-spmv-th4-mem8g-r1.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b spmv -p 2 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-spmv-th2-mem8g-r1.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b spmv -p 1 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-spmv-th1-mem8g-r1.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b spmv -p 16 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-spmv-th16-mem8g-r2.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b spmv -p 8 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-spmv-th8-mem8g-r2.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b spmv -p 4 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-spmv-th4-mem8g-r2.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b spmv -p 2 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-spmv-th2-mem8g-r2.log 2>&1"
"sudo ./bin/benchmark_driver -g rmat_s22_e67 -b spmv -p 1 --physical_memory 8589934592 --measure_scatter_gather > logs/runs/exp3/rmat_s22_e67-spmv-th1-mem8g-r2.log 2>&1"
)

for cmd in "${commands[@]}"; do
  echo "=== Sleeping ${SLEEP}s ==="
  sleep "$SLEEP"
  echo "=== Running: $cmd ==="
  eval "$cmd"
  echo "=== Done ==="
done
